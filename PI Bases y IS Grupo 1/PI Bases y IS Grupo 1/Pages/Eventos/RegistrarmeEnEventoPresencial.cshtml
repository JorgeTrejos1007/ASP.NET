@page
@model PIBasesISGrupo1.Pages.Eventos.RegistrarmeEnEventoPresencialNumeradoModel
@{
    ViewData["Title"] = "RegistrarmeEnEventoPresencialNumerado";
    var nombreEvento = (string)ViewData["nombreEvento"];
    var lugarEvento = (string)ViewData["lugarEvento"];
    var emailCoordinador = (string)ViewData["emailCoordinador"];
    var fechaYHora = (DateTime)ViewData["fechaYHora"];
    var listaSectoresNumerados = (List<PIBasesISGrupo1.Models.Sector>)ViewData["listaSectoresNumerados"];
    var listaSectoresNoNumerado = (List<PIBasesISGrupo1.Models.Sector>)ViewData["listaSectoresNoNumerados"];
}


<head>
    <style type="text/css">
        body {
            background-image: url("/img/event/evento3.jpg");
            background-size: 100%;
        }

        ul.tabs li {
            width: 33%;
        }

        .center-login {
            margin: 0;
            margin-left: 30%;
        }

        .left-login {
            text-align: left;
        }
    </style>
</head>


@Html.AntiForgeryToken()
<div class="cursos-container-2">
    <div class="cajita-cursos col-lg-12" style="width:80%; margin-left:10%;">
        <div class="col-lg-12 right-contents">
            <div style="background-color:#002347; height:70px;">
                <h2 class="title_color align-content-lg-center centrar" style="color:#fdc632; padding:1%;">@nombreEvento</h2>
            </div>
            <hr class="new5">
            <ul>
                <li>
                    <a class="justify-content-between d-flex">
                        <p>Lugar: </p>
                        <span>@lugarEvento</span>
                    </a>
                </li>
                <li>
                    <a class="justify-content-between d-flex">
                        <p>Fecha: </p>
                        <span>@fechaYHora.ToString()</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>

<div class="wrap">
    <ul class="tabs">
        <li><a href="#tab1"><span class="tab-text "> 1. Cantidad de asientos </span></a></li>
        <li><a href="#tab2"><span class="tab-text "> 2. Elija sus asientos </span></a></li>
        <li><a href="#tab3"><span class="tab-text "> 3. Confirme registro </span></a></li>
    </ul>
    <div class="secciones">
        <article id="tab1">

            <div class="modal-dialog" role="document">
                <div class="modal-content center">
                    <div class="modal-header">
                        <div class="center-login">
                            <img class="logo-2" src="~/img/logo.png" alt="" />
                        </div>
                    </div>
                    <div class="modal-body">
                        <div style="">
                            <h2 class="modal-title">Seleccione el tipo de sector</h2>
                            <div class="login-form">
                                <form>
                                    <label>
                                        <input type="radio" name="type" onchange="tipoSector('Numerado')" value="Numerado" required>
                                        Numerado
                                    </label><br>

                                    <label>
                                        <input type="radio" name="type" onchange="tipoSector('No Numerado')" value="No Numerado">
                                        No numerado
                                    </label><br>

                                    <input type="submit" style="display:none">
                                </form>
                                <div class="center-login">
                                    <a class="primary-btn text-uppercase enroll" href="#tab2"> Siguiente</a>
                                    <a href="#tab2"></a>
                                </div>
                                <br>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </article>
        <article id="tab2">
            <div id="registroNumerado" style="display:none">
                <div class="modal-dialog" role="document">
                    <div class="modal-content center">
                        <div class="modal-header">
                            <div class="center-login">
                                <img class="logo-2" src="~/img/logo.png" alt="" />
                            </div>
                        </div>
                        <div class="modal-body">
                            <div>
                                <h2 class="modal-title">Seleccione la ubicación de sus asientos</h2>
                                <div class="login-form">

                                    <div class="input-group mt-10">
                                        <select style="width: 465px;" class="mul-select" id="seleccionarSector" onchange="obtenerAsientos(); ubicacionElegida('seleccionarSector');" required>
                                            <option value="SinSeleccion">- Sin selección -</option>
                                            @foreach (var sector in listaSectoresNumerados)
                                            {
                                                <option value="@sector.nombreDeSector">@sector.nombreDeSector</option>

                                            }
                                        </select>
                                    </div>
                                    <h2 class="modal-title">Seleccione su numero de asiento</h2>

                                    <div id="elegirNumeroAsiento" style="display:none">
                                        <select style="width: 465px;" class="mul-select" multiple id="seleccionarAsiento" required></select>
                                    </div>


                                    <br>
                                    <div class="center-login">
                                        <input class="primary-btn text-uppercase enroll" id="mostrarAsientosElegidos" onclick="asientosElegidos()" value="Siguiente" />
                                    </div>

                                    <br>


                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>


            <div id="registroNoNumerado" style="display:none">
                <div class="modal-dialog" role="document">
                    <div class="modal-content center">
                        <div class="modal-header">
                            <div class="center-login">
                                <img class="logo-2" src="~/img/logo.png" alt="" />
                            </div>
                        </div>
                        <div class="modal-body">
                            <div>
                                <h2 class="modal-title">Seleccione la ubicación de sus asientos</h2>
                                <div class="login-form">

                                    <div class="input-group mt-10">
                                        <select style="width: 465px;" class="mul-select" id="seleccionarSectorNoNumerado" onchange="ubicacionElegida('seleccionarSectorNoNumerado')" required>
                                            <option value="SinSeleccion">- Sin selección -</option>
                                            @foreach (var sector in listaSectoresNoNumerado)
                                            {
                                                <option value="@sector.nombreDeSector">@sector.nombreDeSector</option>

                                            }
                                        </select>
                                    </div>
                                    <h2 class="modal-title">Seleccione la cantidad de asientos</h2>

                                    <input type="number" value="" id="cantidadDeAsientos" required />


                                    <br>
                                    <div class="center-login">
                                        <input class="primary-btn text-uppercase enroll" id="mostrarCantidadAsientosElegida" onclick="cantidadAsientosElegida()" value="Siguiente" />
                                    </div>

                                    <br>


                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>


        </article>
        <article id="tab3">
            <div class="modal-dialog" role="document">
                <div class="modal-content center">
                    <div class="modal-header">
                        <div class="center-login">
                            <img class="logo-2" src="~/img/logo.png" alt="" />
                        </div>
                    </div>
                    <div class="modal-body">
                        <div style="">
                            <h2 class="modal-title">Seleccionado</h2>
                            <div class="login-form">
                                <form method="post">
                                    <!--Aqui va lo de elegir ubicacion de sus asientos-->
                                    <input type="hidden" asp-for="@Model.registro.emailCoordinador" id="registroEmailCoordinador" value="@emailCoordinador" />
                                    <input type="hidden" asp-for="@Model.registro.nombreEvento" id="registroNombreEvento" value="@nombreEvento" />
                                    <input type="hidden" asp-for="@Model.registro.fechaYHora" id="registroFechaYHora" value="@fechaYHora" />
                                    <input type="hidden" asp-for="@Model.registro.tipoDeSector" id="registroTipo" value="" />
                                    <h2>Ubicacion</h2>
                                    <input asp-for="@Model.registro.nombreSector" id="ubicacionEscogida" value="" readonly />

                                    <div id="asientosElegidos" style="display:none">
                                        <h2>Asientos</h2>
                                        <input asp-for="@Model.registro.asientosElegidos" id="asientosEscogidos" value="" readonly />

                                    </div>
                                    <div id="cantidadAsientosElegidos" style="display:none">
                                        <h2>Cantidad</h2>
                                        <input asp-for="@Model.registro.cantidadAsientos" id="cantidadAsientos" value="" readonly />
                                    </div>

                                    <input type="submit" class="primary-btn text-uppercase enroll" value="Confirmar" asp-page-handler="RegistrarmeEnElEvento" />

                                </form>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </article>
    </div>
</div>



<script>
    function ubicacionElegida(seleccionTipoSector) {
        var elem = document.getElementById(seleccionTipoSector).value;
        document.getElementById("ubicacionEscogida").value = "" + elem + "";
    }
    function asientosElegidos() {
        var values = $('#seleccionarAsiento').val();
        document.getElementById("asientosEscogidos").value = "" + values + "";
    }
    function tipoSector(tipo) {
        if (tipo == "Numerado") {
            document.getElementById("registroNumerado").style.display = "block";
            document.getElementById("registroNoNumerado").style.display = "none";

            document.getElementById("asientosElegidos").style.display = "block";
            document.getElementById("cantidadAsientosElegidos").style.display = "none";


            document.getElementById("registroTipo").value = "" + tipo + "";
        }
        else {
            document.getElementById("registroNoNumerado").style.display = "block";
            document.getElementById("registroNumerado").style.display = "none";

            document.getElementById("asientosElegidos").style.display = "none";
            document.getElementById("cantidadAsientosElegidos").style.display = "block";

            document.getElementById("registroTipo").value = "" + tipo + "";
        }
    }
    function cantidadAsientosElegida() {
        var elem = document.getElementById("cantidadDeAsientos").value;
        document.getElementById("cantidadAsientos").value = "" + elem + "";
    }
</script>


<script type="text/javascript">
    function obtenerAsientos() {

        $.ajax({
            type: "POST",
            url: "/Eventos/RegistrarmeEnEventoPresencial?handler=ElegirAsientos",
            beforeSend: function (xhr) {
                xhr.setRequestHeader("XSRF-TOKEN",
                    $('input:hidden[name="__RequestVerificationToken"]').val());
            },
            data: { "nombreSectorElegido": $("#seleccionarSector").val(), "nombreEvento": $("#registroNombreEvento").val(), "emailCoordinador": $("#registroEmailCoordinador").val(), "fechaYHora": $("#registroFechaYHora").val() },
            success: function (response) {
                if (response.asientosDisponibles != null) {
                    document.getElementById("elegirNumeroAsiento").style.display = "block";
                    document.getElementById("seleccionarAsiento").innerHTML = "";
                    for (var i = 0; i < response.asientosDisponibles.length; i++) {
                        var newOption = new Option(response.asientosDisponibles[i], response.asientosDisponibles[i], false, false);
                        $('#seleccionarAsiento').append(newOption).trigger('change');
                    }
                }
                else {
                    document.getElementById("elegirNumeroAsiento").style.display = "none";
                }

            }
        });

    }
</script>



